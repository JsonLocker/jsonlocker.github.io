<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="referrer" content="never">
  

  
  <title>Jsonlocker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Jsonlocker">
<meta property="og:url" content="https://jsonlocker.github.io/page/2/index.html">
<meta property="og:site_name" content="Jsonlocker">
<meta property="og:locale">
<meta property="article:author" content="Jsonlocker">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Jsonlocker" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jsonlocker</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://jsonlocker.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-twig" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/08/04/twig/" class="article-date">
  <time datetime="2021-08-04T05:49:21.000Z" itemprop="datePublished">2021-08-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/php/">php</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/04/twig/">twig</a>
    </h1>
  

      </header>
    

    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <h2 id="install-twig"><a href="#install-twig" class="headerlink" title="install twig"></a>install twig</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">composer  search twig</span><br><span class="line">composer require twig/twig</span><br></pre></td></tr></table></figure>
          
            <p class="article-more-link">
              <a href="/2021/08/04/twig/#more">Read More</a>
            </p>
          
        
      
    </div> 

    <!--div class="article-entry" itemprop="articleBody">
      
        <h2 id="install-twig"><a href="#install-twig" class="headerlink" title="install twig"></a>install twig</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">composer  search twig</span><br><span class="line">composer require twig/twig</span><br></pre></td></tr></table></figure>


<h2 id="create-view"><a href="#create-view" class="headerlink" title="create view"></a>create view</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir view</span><br><span class="line">touch view/index.html</span><br><span class="line">touch index.php</span><br></pre></td></tr></table></figure>

<h2 id="editor-index-php"><a href="#editor-index-php" class="headerlink" title="editor index.php"></a>editor index.php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span>(<span class="string">&#x27;vendor/autoload.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$loader</span> = <span class="keyword">new</span> Twig_Loader_Filesystem(<span class="string">&#x27;view&#x27;</span>);</span><br><span class="line"><span class="variable">$twig</span> = <span class="keyword">New</span> Twig_Environment(<span class="variable">$loader</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$twig</span>-&gt;render(<span class="string">&#x27;hello.html&#x27;</span>, <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span> =&gt; <span class="number">12</span>,</span><br><span class="line">    <span class="string">&#x27;users&#x27;</span> =&gt; [</span><br><span class="line">        [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;miki&#x27;</span>, <span class="string">&#x27;age&#x27;</span> =&gt; <span class="number">33</span>],</span><br><span class="line">        [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;lucy&#x27;</span>, <span class="string">&#x27;age&#x27;</span> =&gt; <span class="number">23</span>]</span><br><span class="line">    ]</span><br><span class="line">));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="editor-index-html"><a href="#editor-index-html" class="headerlink" title="editor index.html"></a>editor index.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">hello, &#123;&#123;name&#125;&#125; , age is &#123;&#123;age&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% if age &gt; 10 %&#125;</span><br><span class="line">    &#123;&#123;name&#125;&#125; is not smaller than 10 years old <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% for user is in users %&#125;</span><br><span class="line">    name is &#123;&#123;user.name&#125;&#125; and age is &#123;&#123;users.age&#125;&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div-->

    <footer class="article-footer">
      <a data-url="https://jsonlocker.github.io/2021/08/04/twig/" data-id="cl5m5t62l0065rhqwdbr24c2c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/twig/" rel="tag">twig</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-opencart-2-安装插件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/08/04/opencart-2-%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6/" class="article-date">
  <time datetime="2021-08-04T03:02:23.000Z" itemprop="datePublished">2021-08-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/php/">php</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/04/opencart-2-%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6/">opencart_2_安装插件</a>
    </h1>
  

      </header>
    

    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <p>扩展插件就是在原程序的基础上再增加一些其他已经有的功能扩展，并且几乎不需要改动原程序代码，安装后即可实现功能，列如语言包插件、支付类型插件等；而修改插件则需要在原程序上改动并生成<br>新文件才能达到新增功能或者修改功能的效果，安装后需要更新ocmod缓存。</p>
          
            <p class="article-more-link">
              <a href="/2021/08/04/opencart-2-安装插件/#more">Read More</a>
            </p>
          
        
      
    </div> 

    <!--div class="article-entry" itemprop="articleBody">
      
        <p>扩展插件就是在原程序的基础上再增加一些其他已经有的功能扩展，并且几乎不需要改动原程序代码，安装后即可实现功能，列如语言包插件、支付类型插件等；而修改插件则需要在原程序上改动并生成<br>新文件才能达到新增功能或者修改功能的效果，安装后需要更新ocmod缓存。</p>
<ol>
<li><p>下载<a target="_blank" rel="noopener" href="https://www.opencart.com/index.php?route=marketplace/extension/info&extension_id=19126&filter_search=language&filter_category_id=2&filter_license=0&filter_download_id=49">安装中文语言包插件</a></p>
</li>
<li><p>官方说明</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">path System -&gt; Localisation -&gt; Languages -&gt; Insert</span><br><span class="line"></span><br><span class="line">fill in with</span><br><span class="line"></span><br><span class="line">Language Name: 简体中文</span><br><span class="line">Code: zh_cn</span><br><span class="line">Locale: zh_CN.UTF-8,zh_CN,zh-cn,china</span><br><span class="line">Image: cn.png</span><br><span class="line">Directory: zh-CN</span><br><span class="line">Filename: zh-CN</span><br><span class="line">Status: Enabled (启动)</span><br><span class="line">Sort Order: 任意数字</span><br><span class="line"></span><br><span class="line">填写后按 Save 存档</span><br><span class="line"></span><br><span class="line">2、setting default language as default</span><br><span class="line"></span><br><span class="line">select：Sytem -&gt; Settings -&gt; Local</span><br><span class="line"></span><br><span class="line">Language: 简体中文</span><br><span class="line">Administration Language: 简体中文</span><br><span class="line"></span><br><span class="line">then Save</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li> 自我描述</li>
</ol>
<p>登录opencart后台 打开插件安装页面 上传插件，上传成功之后会有提示，在这个上传步骤中它做了解压文件、记录插件文件路径 和安装插件记录等这些步骤，<br>我们可以根据路由 marketplace/installer 找到对应的文件去查看它的具体执行步骤。</p>
<p>安装成功之后 还需要去设置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System -&gt;Localisation -&gt; Languages  -&gt;点击新增 -&gt;添加信息 -&gt;保存</span><br><span class="line">Locale: zh,zh-hk,zh-cn,UTF-8,cn-gb,chinese        (语言代码红色字体)</span><br></pre></td></tr></table></figure>

<p>网站语言设置  ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System -&gt; setting -&gt; 编辑  -&gt; local  -&gt; 选择语言 -&gt; 保存</span><br><span class="line"></span><br></pre></td></tr></table></figure>



      
    </div-->

    <footer class="article-footer">
      <a data-url="https://jsonlocker.github.io/2021/08/04/opencart-2-%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6/" data-id="cl5m5t60n004frhqw0v3rcx0p" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/opencart/" rel="tag">opencart</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-javascript-md5" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/08/03/javascript-md5/" class="article-date">
  <time datetime="2021-08-03T07:30:48.000Z" itemprop="datePublished">2021-08-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/03/javascript-md5/">javascript_md5</a>
    </h1>
  

      </header>
    

    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5</span>(<span class="params">inputString</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> hc=<span class="string">&quot;0123456789abcdef&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">rh</span>(<span class="params">n</span>) </span>&#123;<span class="keyword">var</span> j,s=<span class="string">&quot;&quot;</span>;<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;=<span class="number">3</span>;j++) s+=hc.charAt((n&gt;&gt;(j*<span class="number">8</span>+<span class="number">4</span>))&amp;<span class="number">0x0F</span>)+hc.charAt((n&gt;&gt;(j*<span class="number">8</span>))&amp;<span class="number">0x0F</span>);<span class="keyword">return</span> s;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ad</span>(<span class="params">x,y</span>) </span>&#123;<span class="keyword">var</span> l=(x&amp;<span class="number">0xFFFF</span>)+(y&amp;<span class="number">0xFFFF</span>);<span class="keyword">var</span> m=(x&gt;&gt;<span class="number">16</span>)+(y&gt;&gt;<span class="number">16</span>)+(l&gt;&gt;<span class="number">16</span>);<span class="keyword">return</span> (m&lt;&lt;<span class="number">16</span>)|(l&amp;<span class="number">0xFFFF</span>);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">rl</span>(<span class="params">n,c</span>)            </span>&#123;<span class="keyword">return</span> (n&lt;&lt;c)|(n&gt;&gt;&gt;(<span class="number">32</span>-c));&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">cm</span>(<span class="params">q,a,b,x,s,t</span>)    </span>&#123;<span class="keyword">return</span> ad(rl(ad(ad(a,q),ad(x,t)),s),b);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ff</span>(<span class="params">a,b,c,d,x,s,t</span>)  </span>&#123;<span class="keyword">return</span> cm((b&amp;c)|((~b)&amp;d),a,b,x,s,t);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gg</span>(<span class="params">a,b,c,d,x,s,t</span>)  </span>&#123;<span class="keyword">return</span> cm((b&amp;d)|(c&amp;(~d)),a,b,x,s,t);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">hh</span>(<span class="params">a,b,c,d,x,s,t</span>)  </span>&#123;<span class="keyword">return</span> cm(b^c^d,a,b,x,s,t);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ii</span>(<span class="params">a,b,c,d,x,s,t</span>)  </span>&#123;<span class="keyword">return</span> cm(c^(b|(~d)),a,b,x,s,t);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">sb</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> i;<span class="keyword">var</span> nblk=((x.length+<span class="number">8</span>)&gt;&gt;<span class="number">6</span>)+<span class="number">1</span>;<span class="keyword">var</span> blks=<span class="keyword">new</span> <span class="built_in">Array</span>(nblk*<span class="number">16</span>);<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nblk*<span class="number">16</span>;i++) blks[i]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;x.length;i++) blks[i&gt;&gt;<span class="number">2</span>]|=x.charCodeAt(i)&lt;&lt;((i%<span class="number">4</span>)*<span class="number">8</span>);</span><br><span class="line">        blks[i&gt;&gt;<span class="number">2</span>]|=<span class="number">0x80</span>&lt;&lt;((i%<span class="number">4</span>)*<span class="number">8</span>);blks[nblk*<span class="number">16</span>-<span class="number">2</span>]=x.length*<span class="number">8</span>;<span class="keyword">return</span> blks;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> i,x=sb(inputString),a=<span class="number">1732584193</span>,b=-<span class="number">271733879</span>,c=-<span class="number">1732584194</span>,d=<span class="number">271733878</span>,olda,oldb,oldc,oldd;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;x.length;i+=<span class="number">16</span>) &#123;olda=a;oldb=b;oldc=c;oldd=d;</span><br><span class="line">        a=ff(a,b,c,d,x[i+ <span class="number">0</span>], <span class="number">7</span>, -<span class="number">680876936</span>);d=ff(d,a,b,c,x[i+ <span class="number">1</span>],<span class="number">12</span>, -<span class="number">389564586</span>);c=ff(c,d,a,b,x[i+ <span class="number">2</span>],<span class="number">17</span>,  <span class="number">606105819</span>);</span><br><span class="line">        b=ff(b,c,d,a,x[i+ <span class="number">3</span>],<span class="number">22</span>,-<span class="number">1044525330</span>);a=ff(a,b,c,d,x[i+ <span class="number">4</span>], <span class="number">7</span>, -<span class="number">176418897</span>);d=ff(d,a,b,c,x[i+ <span class="number">5</span>],<span class="number">12</span>, <span class="number">1200080426</span>);</span><br><span class="line">        c=ff(c,d,a,b,x[i+ <span class="number">6</span>],<span class="number">17</span>,-<span class="number">1473231341</span>);b=ff(b,c,d,a,x[i+ <span class="number">7</span>],<span class="number">22</span>,  -<span class="number">45705983</span>);a=ff(a,b,c,d,x[i+ <span class="number">8</span>], <span class="number">7</span>, <span class="number">1770035416</span>);</span><br><span class="line">        d=ff(d,a,b,c,x[i+ <span class="number">9</span>],<span class="number">12</span>,-<span class="number">1958414417</span>);c=ff(c,d,a,b,x[i+<span class="number">10</span>],<span class="number">17</span>,     -<span class="number">42063</span>);b=ff(b,c,d,a,x[i+<span class="number">11</span>],<span class="number">22</span>,-<span class="number">1990404162</span>);</span><br><span class="line">        a=ff(a,b,c,d,x[i+<span class="number">12</span>], <span class="number">7</span>, <span class="number">1804603682</span>);d=ff(d,a,b,c,x[i+<span class="number">13</span>],<span class="number">12</span>,  -<span class="number">40341101</span>);c=ff(c,d,a,b,x[i+<span class="number">14</span>],<span class="number">17</span>,-<span class="number">1502002290</span>);</span><br><span class="line">        b=ff(b,c,d,a,x[i+<span class="number">15</span>],<span class="number">22</span>, <span class="number">1236535329</span>);a=gg(a,b,c,d,x[i+ <span class="number">1</span>], <span class="number">5</span>, -<span class="number">165796510</span>);d=gg(d,a,b,c,x[i+ <span class="number">6</span>], <span class="number">9</span>,-<span class="number">1069501632</span>);</span><br><span class="line">        c=gg(c,d,a,b,x[i+<span class="number">11</span>],<span class="number">14</span>,  <span class="number">643717713</span>);b=gg(b,c,d,a,x[i+ <span class="number">0</span>],<span class="number">20</span>, -<span class="number">373897302</span>);a=gg(a,b,c,d,x[i+ <span class="number">5</span>], <span class="number">5</span>, -<span class="number">701558691</span>);</span><br><span class="line">        d=gg(d,a,b,c,x[i+<span class="number">10</span>], <span class="number">9</span>,   <span class="number">38016083</span>);c=gg(c,d,a,b,x[i+<span class="number">15</span>],<span class="number">14</span>, -<span class="number">660478335</span>);b=gg(b,c,d,a,x[i+ <span class="number">4</span>],<span class="number">20</span>, -<span class="number">405537848</span>);</span><br><span class="line">        a=gg(a,b,c,d,x[i+ <span class="number">9</span>], <span class="number">5</span>,  <span class="number">568446438</span>);d=gg(d,a,b,c,x[i+<span class="number">14</span>], <span class="number">9</span>,-<span class="number">1019803690</span>);c=gg(c,d,a,b,x[i+ <span class="number">3</span>],<span class="number">14</span>, -<span class="number">187363961</span>);</span><br><span class="line">        b=gg(b,c,d,a,x[i+ <span class="number">8</span>],<span class="number">20</span>, <span class="number">1163531501</span>);a=gg(a,b,c,d,x[i+<span class="number">13</span>], <span class="number">5</span>,-<span class="number">1444681467</span>);d=gg(d,a,b,c,x[i+ <span class="number">2</span>], <span class="number">9</span>,  -<span class="number">51403784</span>);</span><br><span class="line">        c=gg(c,d,a,b,x[i+ <span class="number">7</span>],<span class="number">14</span>, <span class="number">1735328473</span>);b=gg(b,c,d,a,x[i+<span class="number">12</span>],<span class="number">20</span>,-<span class="number">1926607734</span>);a=hh(a,b,c,d,x[i+ <span class="number">5</span>], <span class="number">4</span>,    -<span class="number">378558</span>);</span><br><span class="line">        d=hh(d,a,b,c,x[i+ <span class="number">8</span>],<span class="number">11</span>,-<span class="number">2022574463</span>);c=hh(c,d,a,b,x[i+<span class="number">11</span>],<span class="number">16</span>, <span class="number">1839030562</span>);b=hh(b,c,d,a,x[i+<span class="number">14</span>],<span class="number">23</span>,  -<span class="number">35309556</span>);</span><br><span class="line">        a=hh(a,b,c,d,x[i+ <span class="number">1</span>], <span class="number">4</span>,-<span class="number">1530992060</span>);d=hh(d,a,b,c,x[i+ <span class="number">4</span>],<span class="number">11</span>, <span class="number">1272893353</span>);c=hh(c,d,a,b,x[i+ <span class="number">7</span>],<span class="number">16</span>, -<span class="number">155497632</span>);</span><br><span class="line">        b=hh(b,c,d,a,x[i+<span class="number">10</span>],<span class="number">23</span>,-<span class="number">1094730640</span>);a=hh(a,b,c,d,x[i+<span class="number">13</span>], <span class="number">4</span>,  <span class="number">681279174</span>);d=hh(d,a,b,c,x[i+ <span class="number">0</span>],<span class="number">11</span>, -<span class="number">358537222</span>);</span><br><span class="line">        c=hh(c,d,a,b,x[i+ <span class="number">3</span>],<span class="number">16</span>, -<span class="number">722521979</span>);b=hh(b,c,d,a,x[i+ <span class="number">6</span>],<span class="number">23</span>,   <span class="number">76029189</span>);a=hh(a,b,c,d,x[i+ <span class="number">9</span>], <span class="number">4</span>, -<span class="number">640364487</span>);</span><br><span class="line">        d=hh(d,a,b,c,x[i+<span class="number">12</span>],<span class="number">11</span>, -<span class="number">421815835</span>);c=hh(c,d,a,b,x[i+<span class="number">15</span>],<span class="number">16</span>,  <span class="number">530742520</span>);b=hh(b,c,d,a,x[i+ <span class="number">2</span>],<span class="number">23</span>, -<span class="number">995338651</span>);</span><br><span class="line">        a=ii(a,b,c,d,x[i+ <span class="number">0</span>], <span class="number">6</span>, -<span class="number">198630844</span>);d=ii(d,a,b,c,x[i+ <span class="number">7</span>],<span class="number">10</span>, <span class="number">1126891415</span>);c=ii(c,d,a,b,x[i+<span class="number">14</span>],<span class="number">15</span>,-<span class="number">1416354905</span>);</span><br><span class="line">        b=ii(b,c,d,a,x[i+ <span class="number">5</span>],<span class="number">21</span>,  -<span class="number">57434055</span>);a=ii(a,b,c,d,x[i+<span class="number">12</span>], <span class="number">6</span>, <span class="number">1700485571</span>);d=ii(d,a,b,c,x[i+ <span class="number">3</span>],<span class="number">10</span>,-<span class="number">1894986606</span>);</span><br><span class="line">        c=ii(c,d,a,b,x[i+<span class="number">10</span>],<span class="number">15</span>,   -<span class="number">1051523</span>);b=ii(b,c,d,a,x[i+ <span class="number">1</span>],<span class="number">21</span>,-<span class="number">2054922799</span>);a=ii(a,b,c,d,x[i+ <span class="number">8</span>], <span class="number">6</span>, <span class="number">1873313359</span>);</span><br><span class="line">        d=ii(d,a,b,c,x[i+<span class="number">15</span>],<span class="number">10</span>,  -<span class="number">30611744</span>);c=ii(c,d,a,b,x[i+ <span class="number">6</span>],<span class="number">15</span>,-<span class="number">1560198380</span>);b=ii(b,c,d,a,x[i+<span class="number">13</span>],<span class="number">21</span>, <span class="number">1309151649</span>);</span><br><span class="line">        a=ii(a,b,c,d,x[i+ <span class="number">4</span>], <span class="number">6</span>, -<span class="number">145523070</span>);d=ii(d,a,b,c,x[i+<span class="number">11</span>],<span class="number">10</span>,-<span class="number">1120210379</span>);c=ii(c,d,a,b,x[i+ <span class="number">2</span>],<span class="number">15</span>,  <span class="number">718787259</span>);</span><br><span class="line">        b=ii(b,c,d,a,x[i+ <span class="number">9</span>],<span class="number">21</span>, -<span class="number">343485551</span>);a=ad(a,olda);b=ad(b,oldb);c=ad(c,oldc);d=ad(d,oldd);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> rh(a)+rh(b)+rh(c)+rh(d);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
          
            <p class="article-more-link">
              <a href="/2021/08/03/javascript-md5/#more">Read More</a>
            </p>
          
        
      
    </div> 

    <!--div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5</span>(<span class="params">inputString</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> hc=<span class="string">&quot;0123456789abcdef&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">rh</span>(<span class="params">n</span>) </span>&#123;<span class="keyword">var</span> j,s=<span class="string">&quot;&quot;</span>;<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;=<span class="number">3</span>;j++) s+=hc.charAt((n&gt;&gt;(j*<span class="number">8</span>+<span class="number">4</span>))&amp;<span class="number">0x0F</span>)+hc.charAt((n&gt;&gt;(j*<span class="number">8</span>))&amp;<span class="number">0x0F</span>);<span class="keyword">return</span> s;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ad</span>(<span class="params">x,y</span>) </span>&#123;<span class="keyword">var</span> l=(x&amp;<span class="number">0xFFFF</span>)+(y&amp;<span class="number">0xFFFF</span>);<span class="keyword">var</span> m=(x&gt;&gt;<span class="number">16</span>)+(y&gt;&gt;<span class="number">16</span>)+(l&gt;&gt;<span class="number">16</span>);<span class="keyword">return</span> (m&lt;&lt;<span class="number">16</span>)|(l&amp;<span class="number">0xFFFF</span>);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">rl</span>(<span class="params">n,c</span>)            </span>&#123;<span class="keyword">return</span> (n&lt;&lt;c)|(n&gt;&gt;&gt;(<span class="number">32</span>-c));&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">cm</span>(<span class="params">q,a,b,x,s,t</span>)    </span>&#123;<span class="keyword">return</span> ad(rl(ad(ad(a,q),ad(x,t)),s),b);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ff</span>(<span class="params">a,b,c,d,x,s,t</span>)  </span>&#123;<span class="keyword">return</span> cm((b&amp;c)|((~b)&amp;d),a,b,x,s,t);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gg</span>(<span class="params">a,b,c,d,x,s,t</span>)  </span>&#123;<span class="keyword">return</span> cm((b&amp;d)|(c&amp;(~d)),a,b,x,s,t);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">hh</span>(<span class="params">a,b,c,d,x,s,t</span>)  </span>&#123;<span class="keyword">return</span> cm(b^c^d,a,b,x,s,t);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ii</span>(<span class="params">a,b,c,d,x,s,t</span>)  </span>&#123;<span class="keyword">return</span> cm(c^(b|(~d)),a,b,x,s,t);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">sb</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> i;<span class="keyword">var</span> nblk=((x.length+<span class="number">8</span>)&gt;&gt;<span class="number">6</span>)+<span class="number">1</span>;<span class="keyword">var</span> blks=<span class="keyword">new</span> <span class="built_in">Array</span>(nblk*<span class="number">16</span>);<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nblk*<span class="number">16</span>;i++) blks[i]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;x.length;i++) blks[i&gt;&gt;<span class="number">2</span>]|=x.charCodeAt(i)&lt;&lt;((i%<span class="number">4</span>)*<span class="number">8</span>);</span><br><span class="line">        blks[i&gt;&gt;<span class="number">2</span>]|=<span class="number">0x80</span>&lt;&lt;((i%<span class="number">4</span>)*<span class="number">8</span>);blks[nblk*<span class="number">16</span>-<span class="number">2</span>]=x.length*<span class="number">8</span>;<span class="keyword">return</span> blks;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> i,x=sb(inputString),a=<span class="number">1732584193</span>,b=-<span class="number">271733879</span>,c=-<span class="number">1732584194</span>,d=<span class="number">271733878</span>,olda,oldb,oldc,oldd;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;x.length;i+=<span class="number">16</span>) &#123;olda=a;oldb=b;oldc=c;oldd=d;</span><br><span class="line">        a=ff(a,b,c,d,x[i+ <span class="number">0</span>], <span class="number">7</span>, -<span class="number">680876936</span>);d=ff(d,a,b,c,x[i+ <span class="number">1</span>],<span class="number">12</span>, -<span class="number">389564586</span>);c=ff(c,d,a,b,x[i+ <span class="number">2</span>],<span class="number">17</span>,  <span class="number">606105819</span>);</span><br><span class="line">        b=ff(b,c,d,a,x[i+ <span class="number">3</span>],<span class="number">22</span>,-<span class="number">1044525330</span>);a=ff(a,b,c,d,x[i+ <span class="number">4</span>], <span class="number">7</span>, -<span class="number">176418897</span>);d=ff(d,a,b,c,x[i+ <span class="number">5</span>],<span class="number">12</span>, <span class="number">1200080426</span>);</span><br><span class="line">        c=ff(c,d,a,b,x[i+ <span class="number">6</span>],<span class="number">17</span>,-<span class="number">1473231341</span>);b=ff(b,c,d,a,x[i+ <span class="number">7</span>],<span class="number">22</span>,  -<span class="number">45705983</span>);a=ff(a,b,c,d,x[i+ <span class="number">8</span>], <span class="number">7</span>, <span class="number">1770035416</span>);</span><br><span class="line">        d=ff(d,a,b,c,x[i+ <span class="number">9</span>],<span class="number">12</span>,-<span class="number">1958414417</span>);c=ff(c,d,a,b,x[i+<span class="number">10</span>],<span class="number">17</span>,     -<span class="number">42063</span>);b=ff(b,c,d,a,x[i+<span class="number">11</span>],<span class="number">22</span>,-<span class="number">1990404162</span>);</span><br><span class="line">        a=ff(a,b,c,d,x[i+<span class="number">12</span>], <span class="number">7</span>, <span class="number">1804603682</span>);d=ff(d,a,b,c,x[i+<span class="number">13</span>],<span class="number">12</span>,  -<span class="number">40341101</span>);c=ff(c,d,a,b,x[i+<span class="number">14</span>],<span class="number">17</span>,-<span class="number">1502002290</span>);</span><br><span class="line">        b=ff(b,c,d,a,x[i+<span class="number">15</span>],<span class="number">22</span>, <span class="number">1236535329</span>);a=gg(a,b,c,d,x[i+ <span class="number">1</span>], <span class="number">5</span>, -<span class="number">165796510</span>);d=gg(d,a,b,c,x[i+ <span class="number">6</span>], <span class="number">9</span>,-<span class="number">1069501632</span>);</span><br><span class="line">        c=gg(c,d,a,b,x[i+<span class="number">11</span>],<span class="number">14</span>,  <span class="number">643717713</span>);b=gg(b,c,d,a,x[i+ <span class="number">0</span>],<span class="number">20</span>, -<span class="number">373897302</span>);a=gg(a,b,c,d,x[i+ <span class="number">5</span>], <span class="number">5</span>, -<span class="number">701558691</span>);</span><br><span class="line">        d=gg(d,a,b,c,x[i+<span class="number">10</span>], <span class="number">9</span>,   <span class="number">38016083</span>);c=gg(c,d,a,b,x[i+<span class="number">15</span>],<span class="number">14</span>, -<span class="number">660478335</span>);b=gg(b,c,d,a,x[i+ <span class="number">4</span>],<span class="number">20</span>, -<span class="number">405537848</span>);</span><br><span class="line">        a=gg(a,b,c,d,x[i+ <span class="number">9</span>], <span class="number">5</span>,  <span class="number">568446438</span>);d=gg(d,a,b,c,x[i+<span class="number">14</span>], <span class="number">9</span>,-<span class="number">1019803690</span>);c=gg(c,d,a,b,x[i+ <span class="number">3</span>],<span class="number">14</span>, -<span class="number">187363961</span>);</span><br><span class="line">        b=gg(b,c,d,a,x[i+ <span class="number">8</span>],<span class="number">20</span>, <span class="number">1163531501</span>);a=gg(a,b,c,d,x[i+<span class="number">13</span>], <span class="number">5</span>,-<span class="number">1444681467</span>);d=gg(d,a,b,c,x[i+ <span class="number">2</span>], <span class="number">9</span>,  -<span class="number">51403784</span>);</span><br><span class="line">        c=gg(c,d,a,b,x[i+ <span class="number">7</span>],<span class="number">14</span>, <span class="number">1735328473</span>);b=gg(b,c,d,a,x[i+<span class="number">12</span>],<span class="number">20</span>,-<span class="number">1926607734</span>);a=hh(a,b,c,d,x[i+ <span class="number">5</span>], <span class="number">4</span>,    -<span class="number">378558</span>);</span><br><span class="line">        d=hh(d,a,b,c,x[i+ <span class="number">8</span>],<span class="number">11</span>,-<span class="number">2022574463</span>);c=hh(c,d,a,b,x[i+<span class="number">11</span>],<span class="number">16</span>, <span class="number">1839030562</span>);b=hh(b,c,d,a,x[i+<span class="number">14</span>],<span class="number">23</span>,  -<span class="number">35309556</span>);</span><br><span class="line">        a=hh(a,b,c,d,x[i+ <span class="number">1</span>], <span class="number">4</span>,-<span class="number">1530992060</span>);d=hh(d,a,b,c,x[i+ <span class="number">4</span>],<span class="number">11</span>, <span class="number">1272893353</span>);c=hh(c,d,a,b,x[i+ <span class="number">7</span>],<span class="number">16</span>, -<span class="number">155497632</span>);</span><br><span class="line">        b=hh(b,c,d,a,x[i+<span class="number">10</span>],<span class="number">23</span>,-<span class="number">1094730640</span>);a=hh(a,b,c,d,x[i+<span class="number">13</span>], <span class="number">4</span>,  <span class="number">681279174</span>);d=hh(d,a,b,c,x[i+ <span class="number">0</span>],<span class="number">11</span>, -<span class="number">358537222</span>);</span><br><span class="line">        c=hh(c,d,a,b,x[i+ <span class="number">3</span>],<span class="number">16</span>, -<span class="number">722521979</span>);b=hh(b,c,d,a,x[i+ <span class="number">6</span>],<span class="number">23</span>,   <span class="number">76029189</span>);a=hh(a,b,c,d,x[i+ <span class="number">9</span>], <span class="number">4</span>, -<span class="number">640364487</span>);</span><br><span class="line">        d=hh(d,a,b,c,x[i+<span class="number">12</span>],<span class="number">11</span>, -<span class="number">421815835</span>);c=hh(c,d,a,b,x[i+<span class="number">15</span>],<span class="number">16</span>,  <span class="number">530742520</span>);b=hh(b,c,d,a,x[i+ <span class="number">2</span>],<span class="number">23</span>, -<span class="number">995338651</span>);</span><br><span class="line">        a=ii(a,b,c,d,x[i+ <span class="number">0</span>], <span class="number">6</span>, -<span class="number">198630844</span>);d=ii(d,a,b,c,x[i+ <span class="number">7</span>],<span class="number">10</span>, <span class="number">1126891415</span>);c=ii(c,d,a,b,x[i+<span class="number">14</span>],<span class="number">15</span>,-<span class="number">1416354905</span>);</span><br><span class="line">        b=ii(b,c,d,a,x[i+ <span class="number">5</span>],<span class="number">21</span>,  -<span class="number">57434055</span>);a=ii(a,b,c,d,x[i+<span class="number">12</span>], <span class="number">6</span>, <span class="number">1700485571</span>);d=ii(d,a,b,c,x[i+ <span class="number">3</span>],<span class="number">10</span>,-<span class="number">1894986606</span>);</span><br><span class="line">        c=ii(c,d,a,b,x[i+<span class="number">10</span>],<span class="number">15</span>,   -<span class="number">1051523</span>);b=ii(b,c,d,a,x[i+ <span class="number">1</span>],<span class="number">21</span>,-<span class="number">2054922799</span>);a=ii(a,b,c,d,x[i+ <span class="number">8</span>], <span class="number">6</span>, <span class="number">1873313359</span>);</span><br><span class="line">        d=ii(d,a,b,c,x[i+<span class="number">15</span>],<span class="number">10</span>,  -<span class="number">30611744</span>);c=ii(c,d,a,b,x[i+ <span class="number">6</span>],<span class="number">15</span>,-<span class="number">1560198380</span>);b=ii(b,c,d,a,x[i+<span class="number">13</span>],<span class="number">21</span>, <span class="number">1309151649</span>);</span><br><span class="line">        a=ii(a,b,c,d,x[i+ <span class="number">4</span>], <span class="number">6</span>, -<span class="number">145523070</span>);d=ii(d,a,b,c,x[i+<span class="number">11</span>],<span class="number">10</span>,-<span class="number">1120210379</span>);c=ii(c,d,a,b,x[i+ <span class="number">2</span>],<span class="number">15</span>,  <span class="number">718787259</span>);</span><br><span class="line">        b=ii(b,c,d,a,x[i+ <span class="number">9</span>],<span class="number">21</span>, -<span class="number">343485551</span>);a=ad(a,olda);b=ad(b,oldb);c=ad(c,oldc);d=ad(d,oldd);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> rh(a)+rh(b)+rh(c)+rh(d);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div-->

    <footer class="article-footer">
      <a data-url="https://jsonlocker.github.io/2021/08/03/javascript-md5/" data-id="cl5m5t5zn003brhqw9ge7fesb" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MD5/" rel="tag">MD5</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-opencart-1-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/08/03/opencart-1-install/" class="article-date">
  <time datetime="2021-08-03T06:26:52.000Z" itemprop="datePublished">2021-08-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/php/">php</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/03/opencart-1-install/">opencart_1_install</a>
    </h1>
  

      </header>
    

    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <h1 id="install-opencart"><a href="#install-opencart" class="headerlink" title="install opencart"></a>install opencart</h1><ol>
          
            <p class="article-more-link">
              <a href="/2021/08/03/opencart-1-install/#more">Read More</a>
            </p>
          
        
      
    </div> 

    <!--div class="article-entry" itemprop="articleBody">
      
        <h1 id="install-opencart"><a href="#install-opencart" class="headerlink" title="install opencart"></a>install opencart</h1><ol>
<li>download <a target="_blank" rel="noopener" href="https://github.com/opencart/opencart/releases">file</a></li>
</ol>
<ol start="2">
<li><p>upload server</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir opcart</span><br><span class="line">rz opencart-3.0.3.7.zip</span><br><span class="line">unzip opencart-3.0.3.7.zip</span><br><span class="line">cd upload</span><br><span class="line">mv dist-config.php config.php</span><br><span class="line">mv admin/dist-config.php  admin/dist-config.php</span><br></pre></td></tr></table></figure></li>
<li><p>config nginx set &amp; set ssl <code>op.czzor.com</code></p>
</li>
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Move</span><br><span class="line"></span><br><span class="line">/www/wwwroot/czzor/opencart/upload/system/storage/</span><br><span class="line"></span><br><span class="line">to</span><br><span class="line"></span><br><span class="line">/www/wwwroot/czzor/opencart/storage/</span><br><span class="line"></span><br><span class="line">Edit config.php change</span><br><span class="line"></span><br><span class="line">define(&#x27;DIR_STORAGE&#x27;, DIR_SYSTEM . &#x27;storage/&#x27;);</span><br><span class="line"></span><br><span class="line">to</span><br><span class="line"></span><br><span class="line">define(&#x27;DIR_STORAGE&#x27;, &#x27;/www/wwwroot/czzor/opencart/storage/&#x27;);</span><br><span class="line"></span><br><span class="line">Edit admin/config.php and change</span><br><span class="line"></span><br><span class="line">define(&#x27;DIR_STORAGE&#x27;, DIR_SYSTEM . &#x27;storage/&#x27;);</span><br><span class="line"></span><br><span class="line">to</span><br><span class="line"></span><br><span class="line">define(&#x27;DIR_STORAGE&#x27;, &#x27;/www/wwwroot/czzor/opencart/storage/&#x27;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>visit:</p>
<ul>
<li><a href="cp.czzor.com">frontend</a></li>
<li><a href="cp.czzor.com/admin">backend</a></li>
</ul>

      
    </div-->

    <footer class="article-footer">
      <a data-url="https://jsonlocker.github.io/2021/08/03/opencart-1-install/" data-id="cl5m5t60g004crhqw1g865nlz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/install/" rel="tag">install</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/opencart/" rel="tag">opencart</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-fetchApi" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/08/02/fetchApi/" class="article-date">
  <time datetime="2021-08-02T09:07:55.000Z" itemprop="datePublished">2021-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/02/fetchApi/">fetchApi</a>
    </h1>
  

      </header>
    

    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <h1 id="fetch-Api"><a href="#fetch-Api" class="headerlink" title="fetch Api"></a>fetch Api</h1><p>XMLHttpRequest 的升级版，用于在 JavaScript 脚本里面发出 HTTP 请求。目前除了ie,主流浏览器都已兼容.</p>
          
            <p class="article-more-link">
              <a href="/2021/08/02/fetchApi/#more">Read More</a>
            </p>
          
        
      
    </div> 

    <!--div class="article-entry" itemprop="articleBody">
      
        <h1 id="fetch-Api"><a href="#fetch-Api" class="headerlink" title="fetch Api"></a>fetch Api</h1><p>XMLHttpRequest 的升级版，用于在 JavaScript 脚本里面发出 HTTP 请求。目前除了ie,主流浏览器都已兼容.</p>
<h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><ol>
<li>简单用法</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fetch(<span class="string">&#x27;http://example.com/movies.json&#x27;</span>)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> response.json();</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">myJson</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(myJson);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Promise 可以使用 await 语法改写，使得语义更清晰。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">async function getJSON() &#123;</span><br><span class="line">  let url = &#x27;http://example.com/movies.json&#x27;;</span><br><span class="line">  try &#123;</span><br><span class="line">    let response = await fetch(url);</span><br><span class="line">    return await response.json();</span><br><span class="line">  &#125; catch (error) &#123;</span><br><span class="line">    console.log(&#x27;Request Failed&#x27;, error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>上传 JSON 数据</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var url = &#x27;https://example.com/profile&#x27;;</span><br><span class="line">var data = &#123;username: &#x27;example&#x27;&#125;;</span><br><span class="line"></span><br><span class="line">fetch(url, &#123;</span><br><span class="line">  method: &#x27;POST&#x27;, // or &#x27;PUT&#x27;</span><br><span class="line">  body: JSON.stringify(data), // data can be `string` or &#123;object&#125;!</span><br><span class="line">  headers: new Headers(&#123;</span><br><span class="line">    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;).then(res =&gt; res.json())</span><br><span class="line">.catch(error =&gt; console.error(&#x27;Error:&#x27;, error))</span><br><span class="line">.then(response =&gt; console.log(&#x27;Success:&#x27;, response));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>带参数用法</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">postData(<span class="string">&#x27;http://example.com/answer&#x27;</span>, &#123;<span class="attr">answer</span>: <span class="number">42</span>&#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">data</span> =&gt;</span> <span class="built_in">console</span>.log(data)) <span class="comment">// JSON from `response.json()` call</span></span><br><span class="line">  .catch(<span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.error(error))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">postData</span>(<span class="params">url, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> fetch(url, &#123;</span><br><span class="line">    <span class="attr">body</span>: <span class="built_in">JSON</span>.stringify(data), <span class="comment">// must match &#x27;Content-Type&#x27; header</span></span><br><span class="line">    <span class="attr">cache</span>: <span class="string">&#x27;no-cache&#x27;</span>, <span class="comment">// *default, no-cache, reload, force-cache, only-if-cached</span></span><br><span class="line">    <span class="attr">credentials</span>: <span class="string">&#x27;same-origin&#x27;</span>, <span class="comment">// include, same-origin, *omit</span></span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/4.0 MDN Example&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>, <span class="comment">// *GET, POST, PUT, DELETE, etc.</span></span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;cors&#x27;</span>, <span class="comment">// no-cors, cors, *same-origin</span></span><br><span class="line">    <span class="attr">redirect</span>: <span class="string">&#x27;follow&#x27;</span>, <span class="comment">// manual, *follow, error</span></span><br><span class="line">    <span class="attr">referrer</span>: <span class="string">&#x27;no-referrer&#x27;</span>, <span class="comment">// *client, no-referrer</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">response</span> =&gt;</span> response.json()) <span class="comment">// parses response to JSON</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>上传文件</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line"><span class="keyword">var</span> fileField = <span class="built_in">document</span>.querySelector(<span class="string">&quot;input[type=&#x27;file&#x27;]&quot;</span>);</span><br><span class="line"></span><br><span class="line">formData.append(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;abc123&#x27;</span>);</span><br><span class="line">formData.append(<span class="string">&#x27;avatar&#x27;</span>, fileField.files[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">fetch(<span class="string">&#x27;https://example.com/profile/avatar&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">  <span class="attr">body</span>: formData</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">response</span> =&gt;</span> response.json())</span><br><span class="line">.catch(<span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.error(<span class="string">&#x27;Error:&#x27;</span>, error))</span><br><span class="line">.then(<span class="function"><span class="params">response</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;Success:&#x27;</span>, response));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>上传多个文件</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line"><span class="keyword">var</span> photos = <span class="built_in">document</span>.querySelector(<span class="string">&quot;input[type=&#x27;file&#x27;][multiple]&quot;</span>);</span><br><span class="line"></span><br><span class="line">formData.append(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;My Vegas Vacation&#x27;</span>);</span><br><span class="line"><span class="comment">// formData 只接受文件、Blob 或字符串，不能直接传递数组，所以必须循环嵌入</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; photos.files.length; i++) &#123;</span><br><span class="line">    formData.append(<span class="string">&#x27;photo&#x27;</span>, photos.files[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fetch(<span class="string">&#x27;https://example.com/posts&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">  <span class="attr">body</span>: formData</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">response</span> =&gt;</span> response.json())</span><br><span class="line">.then(<span class="function"><span class="params">response</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;Success:&#x27;</span>, <span class="built_in">JSON</span>.stringify(response)))</span><br><span class="line">.catch(<span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.error(<span class="string">&#x27;Error:&#x27;</span>, error));</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>response</li>
</ol>
<p>fetch()请求成功以后，得到的是一个 Response 对象。它对应服务器的 HTTP 回应。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const response = await fetch(url);</span><br></pre></td></tr></table></figure>

<p>前面说过，Response 包含的数据通过 Stream 接口异步读取，但是它还包含一些同步属性，对应 HTTP 回应的标头信息（Headers），可以立即读取。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">async function fetchText() &#123;</span><br><span class="line">  let response = await fetch(&#x27;/readme.txt&#x27;);</span><br><span class="line">  console.log(response.status);</span><br><span class="line">  console.log(response.statusText);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Response.ok</li>
</ul>
<p>Response.ok属性返回一个布尔值，表示请求是否成功，true对应 HTTP 请求的状态码 200 到 299，false对应其他的状态码。</p>
<ul>
<li>Response.status</li>
</ul>
<p>Response.status属性返回一个数字，表示 HTTP 回应的状态码（例如200，表示成功请求）。</p>
<ul>
<li>Response.statusText</li>
</ul>
<p>Response.statusText属性返回一个字符串，表示 HTTP 回应的状态信息（例如请求成功以后，服务器返回”OK”）。</p>
<ul>
<li>Response.url</li>
</ul>
<p>Response.url属性返回请求的 URL。如果 URL 存在跳转，该属性返回的是最终 URL。</p>
<ul>
<li>Response.type</li>
</ul>
<p>Response.type属性返回请求的类型。可能的值如下：</p>
<pre><code>- basic：普通请求，即同源请求。
- cors：跨域请求。
- error：网络错误，主要用于 Service Worker。
- opaque：如果fetch()请求的type属性设为no-cors，就会返回这个值，详见请求部分。表示发出的是简单的跨域请求，类似&lt;form&gt;表单的那种跨域请求。
- opaqueredirect：如果fetch()请求的redirect属性设为manual，就会返回这个值，详见请求部分。
</code></pre>
<ul>
<li>Response.redirected</li>
</ul>
<p>Response.redirected属性返回一个布尔值，表示请求是否发生过跳转。</p>
<ol start="7">
<li>body</li>
</ol>
<p>Body 类定义了以下方法（这些方法都被 Request 和Response所实现）以获取 body 内容。这些方法都会返回一个被解析后的Promise (en-US)对象和数据。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer">ArrayBuffer()</a><ul>
<li>得到二进制 ArrayBuffer 对象。主要用于获取流媒体文件</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/blob">blob()</a><ul>
<li>得到二进制 Blob 对象。用于获取图片等二进制文件。</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/json">json() (en-US)</a><ul>
<li>得到 JSON 对象。</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/text">text() (en-US)</a><ul>
<li>得到文本字符串。比如 HTML 文件。</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Response/formData">formData() (en-US)</a><ul>
<li>得到 FormData 表单对象。</li>
</ul>
</li>
</ul>
<p>==上面5个读取方法都是异步的，返回的都是 Promise 对象。必须等到异步操作结束，才能得到服务器返回的完整数据。==</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = <span class="keyword">new</span> FormData(<span class="built_in">document</span>.getElementById(<span class="string">&#x27;login-form&#x27;</span>));</span><br><span class="line">fetch(<span class="string">&quot;/login&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">  <span class="attr">body</span>: form</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="8">
<li>Polyfill</li>
</ol>
<p>如果要在不支持的浏览器中使用 Fetch，可以使用 <a target="_blank" rel="noopener" href="https://github.com/github/fetch">Fetch Polyfill</a>。</p>
<h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2020/12/fetch-tutorial.html">阮一峰博客</a><br><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch">mozilla</a></p>
</blockquote>

      
    </div-->

    <footer class="article-footer">
      <a data-url="https://jsonlocker.github.io/2021/08/02/fetchApi/" data-id="cl5m5t5zf002zrhqw192c1a1j" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fetch/" rel="tag">fetch</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-localStorage" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/08/02/localStorage/" class="article-date">
  <time datetime="2021-08-02T00:52:34.000Z" itemprop="datePublished">2021-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Javascript/">Javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/02/localStorage/">localStorage</a>
    </h1>
  

      </header>
    

    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <h3 id="1-Set-expiry-time-TTL-for-LocalStorage"><a href="#1-Set-expiry-time-TTL-for-LocalStorage" class="headerlink" title="1. Set expiry time(TTL) for LocalStorage"></a>1. Set expiry time(TTL) for LocalStorage</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setWithExpiry</span>(<span class="params">key, value, ttl</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">new</span> = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> item = &#123;</span><br><span class="line">    	<span class="attr">value</span> : value</span><br><span class="line">	<span class="attr">expiry</span> : <span class="keyword">new</span>.getTime() + ttl </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    localstorage.setItem(key, <span class="built_in">JSON</span>.stringify(item))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
          
            <p class="article-more-link">
              <a href="/2021/08/02/localStorage/#more">Read More</a>
            </p>
          
        
      
    </div> 

    <!--div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-Set-expiry-time-TTL-for-LocalStorage"><a href="#1-Set-expiry-time-TTL-for-LocalStorage" class="headerlink" title="1. Set expiry time(TTL) for LocalStorage"></a>1. Set expiry time(TTL) for LocalStorage</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setWithExpiry</span>(<span class="params">key, value, ttl</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">new</span> = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> item = &#123;</span><br><span class="line">    	<span class="attr">value</span> : value</span><br><span class="line">	<span class="attr">expiry</span> : <span class="keyword">new</span>.getTime() + ttl </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    localstorage.setItem(key, <span class="built_in">JSON</span>.stringify(item))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="2-Get-items-from-LocalStorage"><a href="#2-Get-items-from-LocalStorage" class="headerlink" title="2. Get items from LocalStorage"></a>2. Get items from LocalStorage</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function getWithExpiry(key)&#123;</span><br><span class="line">    const itemStr = localstorage.getItem(key)</span><br><span class="line">    </span><br><span class="line">    if(!itemStr)&#123;</span><br><span class="line">    	return null</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    const item = JSON.parse(itemStr)</span><br><span class="line">    const now = new Date()</span><br><span class="line">    if( now.getTime() &gt; item.expiry )&#123;</span><br><span class="line">    	localStorage.removeItem(key)</span><br><span class="line">    &#125;</span><br><span class="line">    return item.value</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div-->

    <footer class="article-footer">
      <a data-url="https://jsonlocker.github.io/2021/08/02/localStorage/" data-id="cl5m5t600003xrhqw57pm8vwv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Localstorage/" rel="tag">Localstorage</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-patter-composite" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/06/16/patter-composite/" class="article-date">
  <time datetime="2021-06-16T09:26:24.000Z" itemprop="datePublished">2021-06-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/patterns/">patterns</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/06/16/patter-composite/">组合模式</a>
    </h1>
  

      </header>
    

    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <h2 id="组合模式"><a href="#组合模式" class="headerlink" title="组合模式"></a>组合模式</h2><p>组合模式将对象组合成树形结构，以表示‘部分-整体’的层次结构。</p>
          
            <p class="article-more-link">
              <a href="/2021/06/16/patter-composite/#more">Read More</a>
            </p>
          
        
      
    </div> 

    <!--div class="article-entry" itemprop="articleBody">
      
        <h2 id="组合模式"><a href="#组合模式" class="headerlink" title="组合模式"></a>组合模式</h2><p>组合模式将对象组合成树形结构，以表示‘部分-整体’的层次结构。</p>
<p>在组合模式，客户端访问独立对象和组合对象（或称对象集合）一样。</p>
<p>独立对象是一个有特定功能的对象，它不引用其他任何其他对象。</p>
<p>组合对象则是一个提供相似功能对象的集合，主要用来管理独立对象，并为客户端提供和独立对象一样的访问方式。</p>
<p>接下来，我们就以目录和文件来举例，利用它们的一个相同的功能“查看大小”来举例。</p>
<h2 id="1-问题"><a href="#1-问题" class="headerlink" title="1 问题"></a>1 问题</h2><p>在文件系统中，我们有文本文件、图片文件、视频文件等类型的文件。</p>
<p>它们格式不同，但都有容量大小。</p>
<p>现在，我们创建文本和图片文件两个类，且各自有固定的大小。</p>
<p>（实际当然不是如此，这里举例所以简化处理。）</p>
<p>接着，我们要获取文件和目录的大小。</p>
<p>首先是文件：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">File</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">getSize</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextFile</span> <span class="keyword">extends</span> <span class="title">File</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageFile</span> <span class="keyword">extends</span> <span class="title">File</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样，在创建文本或图片对象后，就可以通过getSize()方法获取到它们的大小。</p>
<p>然后，我们创建一个目录类，它可以把文件组合起来：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dir</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 传入参数必须为File文件对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addFile</span>(<span class="params">File <span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;files[] = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$size</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;files <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">            <span class="variable">$size</span> += <span class="variable">$file</span>-&gt;getSize();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$size</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后，我们就可以计算目录的大小，它等于目录下所有文件大小之和。</p>
<p>例如，这个目录加入一个文本文件，一个图片文件，那么这个目录大小就是：102。</p>
<p>当然，如果问题一直这样简单的话，那么这个模型还是非常令人满意的。</p>
<p>但是，如果有一些新的需求加入会怎样？</p>
<p>比如，要在目录中再加一层目录，那么Dir类就需要变成：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewDir</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$dirs</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addFile</span>(<span class="params">File <span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;files[] = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addDir</span>(<span class="params">NewDir <span class="variable">$newDir</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;dirs = <span class="variable">$newDir</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$size</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;files <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">            <span class="variable">$size</span> += <span class="variable">$file</span>-&gt;getSize();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;dirs <span class="keyword">as</span> <span class="variable">$dir</span>) &#123;</span><br><span class="line">            <span class="variable">$size</span> += <span class="variable">$dir</span>-&gt;getSize();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$size</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>是不是比之前又复杂了些？</p>
<p>这还不算，我们还需要修改原来的类，可能无意间又影响原来的功能 。</p>
<p>另外，如果我们现在要计算多级子目录的大小、或者从目录中删除目录，是不是还需要修改原有类？</p>
<p>显然，这个模型无法实现这些复杂的功能，我们需要一个更加灵活的模型。</p>
<h2 id="2-组合模式"><a href="#2-组合模式" class="headerlink" title="2 组合模式"></a>2 组合模式</h2><p>组合模式的解决方法是，用抽象类规范统一的对外接口。</p>
<p>然后，让文件类和目录类实现这个接口，并在目录类中递归计算文件的大小。</p>
<p>同时，目录类比文件类两个方法：add()和remove()，用以管理文件对象。</p>
<p>这样，目录类就能用同样的方式获取自身的大小。</p>
<p>并且，还能灵活从目录总增删子目录和文件。</p>
<h3 id="2-1-接口"><a href="#2-1-接口" class="headerlink" title="2.1 接口"></a>2.1 接口</h3><p>接口用于规范独立对象和组合对象，保证能够对外提供一致性的使用方法。</p>
<p>这里以getName()和getSize()方法为例：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 规范独立对象和组合对象必须实现的方法，保证它们提供给客户端统一的</span></span><br><span class="line"><span class="comment"> * 访问方式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Filesystem</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>)</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">function</span> <span class="title">getSize</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其中，__construct构建函数用于传入文件或目录名称，并非必须。</p>
<p>这个接口中规范的方法要根据需求来定义，并且同时要考虑独立对象拥有的功能。</p>
<p>如果独立对象之间有差异的功能，不适合聚合在一起，则不能放在组合类中。</p>
<h3 id="2-2-目录类"><a href="#2-2-目录类" class="headerlink" title="2.2 目录类"></a>2.2 目录类</h3><p>目录类是对象集合，通过add()和remove()方法管理文件对象和其他目录对象。</p>
<p>目录类也需要实现抽象类中的方法，以提供给客户端一致性的使用方式。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 目录类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dir</span> <span class="keyword">extends</span> <span class="title">Filesystem</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$filesystems</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 组合对象必须实现添加方法。因为传入参数规定为Filesystem类型，</span></span><br><span class="line">    <span class="comment">// 所以目录和文件都能添加</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">Filesystem <span class="variable">$filesystem</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$key</span> = array_search(<span class="variable">$filesystem</span>, <span class="keyword">$this</span>-&gt;filesystems);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$key</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;filesystems[] = <span class="variable">$filesystem</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 组合对象必须实现移除方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">remove</span>(<span class="params">Filesystem <span class="variable">$filesystem</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$key</span> = array_search(<span class="variable">$filesystem</span>, <span class="keyword">$this</span>-&gt;filesystems);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$key</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;filesystems[<span class="variable">$key</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;目录：&#x27;</span> . <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$size</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;filesystems <span class="keyword">as</span> <span class="variable">$filesystem</span>) &#123;</span><br><span class="line">            <span class="variable">$size</span> += <span class="variable">$filesystem</span>-&gt;getSize();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$size</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-3-文件类"><a href="#2-3-文件类" class="headerlink" title="2.3 文件类"></a>2.3 文件类</h3><p>文件类实现具体的功能，但是没有add()和remove()方法。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 独立对象：文本文件类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextFile</span> <span class="keyword">extends</span> <span class="title">Filesystem</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;文本文件：&#x27;</span> . <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 独立对象2：图片文件类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageFile</span> <span class="keyword">extends</span> <span class="title">Filesystem</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;图片：&#x27;</span> . <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 独立对象：视频文件类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VideoFile</span> <span class="keyword">extends</span> <span class="title">Filesystem</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;视频：&#x27;</span>. <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">200</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>组合模式中，组合对象必须在合适的地方提供独立对象的管理方法，如：add()、remove()等。</p>
<p>组合模式分为安全模式和透明模式，这是根据接口中是否包含管理对象的方法来区分的。</p>
<p>上面的例子我们举例的是安全模式，在接口中没有声明add()和remove()方法管理方法。</p>
<p>这样有一个缺点：组合对象和独立对象不具有相同的接口，客户端调用需要做相应的判断，带来了不便。</p>
<p>另外一种是透明模式，在接口中就声明add()和remove()方法。</p>
<p>这样所有的实现类都具备了add()和remove()，好处就是组合对象和独立对象具有一致的接口。</p>
<p>但问题也很明显，因为独立对象不具备add()、remove()方法的功能，所以实现他是没有意义的。</p>
<p>不管那种模式，都根据实际需要来配置。</p>
<h3 id="2-4-客户端"><a href="#2-4-客户端" class="headerlink" title="2.4 客户端"></a>2.4 客户端</h3><p>然后，我们就可以在客户端中使用这个程序。</p>
<p>例如，我们要构建这样一个文件目录结构：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">home</span><br><span class="line">├─text1.txt</span><br><span class="line">├─bg1.png</span><br><span class="line">├─film1.mp4</span><br><span class="line">├─source</span><br><span class="line">│  ├─text2.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>代码就是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 创建home目录，并加入三个文件</span><br><span class="line">$dir = new Dir(&#x27;home&#x27;);</span><br><span class="line">$dir-&gt;add(new TextFile(&#x27;text1.txt&#x27;));</span><br><span class="line">$dir-&gt;add(new ImageFile(&#x27;bg1.png&#x27;));</span><br><span class="line">$dir-&gt;add(new VideoFile(&#x27;film1.mp4&#x27;));</span><br><span class="line"></span><br><span class="line">// 在home下创建子目录source</span><br><span class="line">$subDir = new Dir(&#x27;source&#x27;);</span><br><span class="line">$dir-&gt;add($subDir);</span><br><span class="line"></span><br><span class="line">// 创建一个text2.txt，并放到子目录source中</span><br><span class="line">$text2 = new TextFile(&#x27;text2.txt&#x27;);</span><br><span class="line">$subDir-&gt;add($text2);</span><br><span class="line"></span><br><span class="line">// 打印信息</span><br><span class="line">echo $text2-&gt;getName(), &#x27;--&gt;&#x27;, $text2-&gt;getSize();</span><br><span class="line">echo &#x27;&lt;br /&gt;&#x27;;</span><br><span class="line">echo $subDir-&gt;getName(), &#x27; --&gt; &#x27;,$subDir-&gt;getSize();</span><br><span class="line">echo &#x27;&lt;br /&gt;&#x27;;</span><br><span class="line">echo $dir-&gt;getName(), &#x27; --&gt; &#x27;, $dir-&gt;getSize();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以看到，文件对象（独立对象）获取名称用getName()方法，目录对象（组合对象）用的也是getName()方法。</p>
<p>同样，获取大小用的也都是getSize()方法。</p>
<p>输出的结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">文本文件：text2.txt--&gt;10</span><br><span class="line">目录：source --&gt; 10</span><br><span class="line">目录：home --&gt; 320</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="3-特点"><a href="#3-特点" class="headerlink" title="3 特点"></a>3 特点</h2><p>在组合模式中，组合对象和独立对象必须实现一个接口。</p>
<p>其中，组合对象必须包含添加和删除节点对象。</p>
<p>组合模式通过和装饰模式有着类似的结构图，但是组合模式旨在构造类，而装饰模式重在不生成子类即可给对象添加职责。</p>
<p>并且，装饰模式重在修饰，而组合模式重在表示。</p>

      
    </div-->

    <footer class="article-footer">
      <a data-url="https://jsonlocker.github.io/2021/06/16/patter-composite/" data-id="cl5m5t60u004krhqw5rz33ad5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/composite/" rel="tag">composite</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/patterns/" rel="tag">patterns</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/" rel="tag">php</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-patter-observer-php" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/06/16/patter-observer-php/" class="article-date">
  <time datetime="2021-06-16T09:13:55.000Z" itemprop="datePublished">2021-06-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/patterns/">patterns</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/06/16/patter-observer-php/">观察者模式</a>
    </h1>
  

      </header>
    

    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <h2 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h2><p>观察者模式，也称发布-订阅模式，定义了一个被观察者和多个观察者的、一对多的对象关系。</p>
          
            <p class="article-more-link">
              <a href="/2021/06/16/patter-observer-php/#more">Read More</a>
            </p>
          
        
      
    </div> 

    <!--div class="article-entry" itemprop="articleBody">
      
        <h2 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h2><p>观察者模式，也称发布-订阅模式，定义了一个被观察者和多个观察者的、一对多的对象关系。</p>
<p>在被观察者状态发生变化的时候，它的所有观察者都会收到通知，并自动更新。</p>
<p>观察者模式通常用在实时事件处理系统、组件间解耦、数据库驱动的消息队列系统，同时也是MVC设计模式中的重要组成部分。</p>
<p>以下我们以订单创建为例。</p>
<p>当订单创建后，系统会发送邮件和短信，并保存日志记录。</p>
<h3 id="1-问题"><a href="#1-问题" class="headerlink" title="1 问题"></a>1 问题</h3><p>在没有用观察者模式的时候，如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 订单状态</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$state</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 订单状态有变化时发送通知</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addOrder</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;state = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// 发送邮件</span></span><br><span class="line">        Email::update(<span class="keyword">$this</span>-&gt;state);</span><br><span class="line">        <span class="comment">// 短信通知</span></span><br><span class="line">        Message::update(<span class="keyword">$this</span>-&gt;state);</span><br><span class="line">        <span class="comment">// 记录日志</span></span><br><span class="line">        Log::update();</span><br><span class="line">        <span class="comment">// 其他更多通知</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>代码中，在Order类中调用各类的方法来实现通知。当在客户端创建订单：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable">$order</span> = <span class="keyword">new</span> Order();</span><br><span class="line"><span class="variable">$order</span>-&gt;addOrder();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>就会同时产生三个通知：发送邮件、发送短信和记录日志。</p>
<p>在系统小的时候，这是非常快捷有效的方式。</p>
<p>可是，当系统变大的时候，这种方法马上面临难以扩展的问题，并且容易出错：</p>
<p>如果订单不需要某种通知，比如不需要记录日志，则必须修改Order类，做状态的判断；</p>
<p>如果再加一种通知方式，如系统消息通知，则除了增加新类，同时还需要修改Order类和客户端。</p>
<p>这两条都不符合面向对象中的开闭原则，会让系统越来越难维护。</p>
<h3 id="2-解决"><a href="#2-解决" class="headerlink" title="2 解决"></a>2 解决</h3><p>接下来我们用观察者模式解决这个问题。</p>
<h4 id="2-1-被观察者"><a href="#2-1-被观察者" class="headerlink" title="2.1 被观察者"></a>2.1 被观察者</h4><p>被观察者是一些具体的实例，比如订单管理、用户登陆、评论回复、状态审核等等。</p>
<p>别的功能会依赖于它们的状态进行各种动作。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 被观察者接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Observable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 添加/注册观察者</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">attach</span>(<span class="params">Observer <span class="variable">$observer</span></span>)</span>;</span><br><span class="line">    <span class="comment">// 删除观察者</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">detach</span>(<span class="params">Observer <span class="variable">$observer</span></span>)</span>;</span><br><span class="line">    <span class="comment">// 触发通知</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notify</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 被观察者</span></span><br><span class="line"><span class="comment"> * 职责：添加观察者到$observers属性中，</span></span><br><span class="line"><span class="comment"> * 有变动时通过notify()方法运行通知</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> <span class="keyword">implements</span> <span class="title">Observable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 保存观察者</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$observers</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="comment">// 订单状态</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$state</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加（注册）观察者</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">attach</span>(<span class="params">Observer <span class="variable">$observer</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$key</span> = array_search(<span class="variable">$observer</span>, <span class="keyword">$this</span>-&gt;observers);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$key</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;observers[] = <span class="variable">$observer</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 移除观察者</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">detach</span>(<span class="params">Observer <span class="variable">$observer</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$key</span> = array_search(<span class="variable">$observer</span>, <span class="keyword">$this</span>-&gt;observers);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$key</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;observers[<span class="variable">$key</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 遍历调用观察者的update()方法进行通知，不关心其具体实现方式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notify</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;observers <span class="keyword">as</span> <span class="variable">$observer</span>) &#123;</span><br><span class="line">            <span class="comment">// 把本类对象传给观察者，以便观察者获取当前类对象的信息</span></span><br><span class="line">            <span class="variable">$observer</span>-&gt;update(<span class="keyword">$this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 订单状态有变化时发送通知</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addOrder</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;state = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;notify();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取提供给观察者的状态</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getState</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>被观察者至少要实现attach()、detach()、notify()三个方法，用以添加、删除和通知观察者。</p>
<p>通知的方式是，在类中的其他方法（如：创建订单）调用notify()方法。</p>
<p>另外，观察者可能用到被观察者的一些状态信息。</p>
<p>所以，要在notify()中把当前对象作为参数传给观察者，方便其通过提供的public方法获得被观察者的状态信息。</p>
<p>本例用getState()方法供给观察者获取状态信息。</p>
<h3 id="2-2-观察者"><a href="#2-2-观察者" class="headerlink" title="2.2 观察者"></a>2.2 观察者</h3><p>观察者可能有多个，但每个观察者都必须实现Observer接口规定的update()方法，这是接收被观察者通知的唯一渠道。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 接收到通知的处理方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">Observable <span class="variable">$observable</span></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者1：发送邮件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Email</span> <span class="keyword">implements</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">Observable <span class="variable">$observable</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$state</span> = <span class="variable">$observable</span>-&gt;getState();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$state</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;发送邮件：您已经成功下单。&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;发送邮件：下单失败，请重试。&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者2：短信通知</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Message</span> <span class="keyword">implements</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">Observable <span class="variable">$observable</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$state</span> = <span class="variable">$observable</span>-&gt;getState();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$state</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;短信通知：您已下单成功。&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;短信通知：下单失败，请重试。&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者3：记录日志</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Log</span> <span class="keyword">implements</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">Observable <span class="variable">$observable</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;记录日志：生成了一个订单记录。&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里有三个观察者：发送邮件、短信通知和记录日志，它们都实现了update()方法。</p>
<p>其中，发送邮件和短信依赖于订单、也就是被观察者的状态，来决定发送消息的内容，记录日志则不需要订单的状态。</p>
<h3 id="2-3-客户端"><a href="#2-3-客户端" class="headerlink" title="2.3 客户端"></a>2.3 客户端</h3><p>然后我们创建一个客户端，内容：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 创建观察者对象</span></span><br><span class="line"><span class="variable">$email</span> = <span class="keyword">new</span> Email();</span><br><span class="line"><span class="variable">$message</span> = <span class="keyword">new</span> Message();</span><br><span class="line"><span class="variable">$log</span> = <span class="keyword">new</span> Log();</span><br><span class="line"><span class="comment">// 创建订单对象</span></span><br><span class="line"><span class="variable">$order</span> = <span class="keyword">new</span> Order();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向订单对象中注册3个观察者：发送邮件、短信通知、记录日志</span></span><br><span class="line"><span class="variable">$order</span>-&gt;attach(<span class="variable">$email</span>);</span><br><span class="line"><span class="variable">$order</span>-&gt;attach(<span class="variable">$message</span>);</span><br><span class="line"><span class="variable">$order</span>-&gt;attach(<span class="variable">$log</span>);</span><br><span class="line"><span class="comment">// 添加订单，添加时会自动发送通知给观察者</span></span><br><span class="line"><span class="variable">$order</span>-&gt;addOrder();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除记录日志观察者</span></span><br><span class="line"><span class="variable">$order</span>-&gt;detach(<span class="variable">$log</span>);</span><br><span class="line"><span class="comment">// 添加另一个订单，会再次发送通知给观察着</span></span><br><span class="line"><span class="variable">$order</span>-&gt;addOrder();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>执行应用后，会输出这样的消息：</p>
<p>发送邮件：您已经成功下单。添加日志：生成了一个订单记录。系统消息：您已下单成功。</p>
<p>发送邮件：您已经成功下单。添加日志：生成了一个订单记录。</p>
<p>对于不需要通知的观察者，用detach()移出观察者列表即可。</p>
<p>这种情况就解开了类之间的耦合。</p>
<h3 id="2-4-新增观察者"><a href="#2-4-新增观察者" class="headerlink" title="2.4 新增观察者"></a>2.4 新增观察者</h3><p>如果再需要新增一个观察者，如下，只需要添加观察者类本身，实现update()方法。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 观察者4：系统消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Alert</span> <span class="keyword">implements</span> <span class="title">Observer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">Observable <span class="variable">$observable</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;系统消息：您的订单有更新了~~~&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">再到客户端中注册Alert类到观察者列表中：</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建“系统消息”观察者</span></span><br><span class="line"><span class="variable">$alert</span> = <span class="keyword">new</span> Alert();</span><br><span class="line"><span class="comment">// 注册观察者到订单对象中</span></span><br><span class="line"><span class="variable">$order</span>-&gt;attach(<span class="variable">$alert</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>就能订阅被观察者的通知。</p>
<h2 id="3-特点"><a href="#3-特点" class="headerlink" title="3 特点"></a>3 特点</h2><p>在观察者模式中，被观察者完全不需要关心观察者，在自身状态有变化是，遍历执行观察者update()方法即完成通知。</p>
<p>在观察者模式中，被观察者通过添加attach()方法，提供给观察者注册，使自己变得可见。</p>
<p>当被观察者改变时，给注册的观察者发送通知。至于观察者如何处理通知，被观察者不需要关心。</p>
<p>这是一种良好的设计，对象之间不必相互理解，同样能够相互通信。</p>
<p>面向对象编程中，任何对象的状态都非常重要，它们是对象间交互的桥梁。</p>
<p>当一个对象的改变需要被其他对象关注时，观察者模式就派上用场了。</p>

      
    </div-->

    <footer class="article-footer">
      <a data-url="https://jsonlocker.github.io/2021/06/16/patter-observer-php/" data-id="cl5m5t610004rrhqwf3dg7n7j" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/observer/" rel="tag">observer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/patterns/" rel="tag">patterns</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/" rel="tag">php</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-patter-simple-factory-php" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/06/16/patter-simple-factory-php/" class="article-date">
  <time datetime="2021-06-16T09:06:31.000Z" itemprop="datePublished">2021-06-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/patterns/">patterns</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/06/16/patter-simple-factory-php/">简单工厂</a>
    </h1>
  

      </header>
    

    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <h2 id="简单工厂"><a href="#简单工厂" class="headerlink" title="简单工厂"></a>简单工厂</h2><p>类如果直接都用new,那有一天命名需要改动的时候得搜索每一行代码去改，而工厂避免了这种情况</p>
          
            <p class="article-more-link">
              <a href="/2021/06/16/patter-simple-factory-php/#more">Read More</a>
            </p>
          
        
      
    </div> 

    <!--div class="article-entry" itemprop="articleBody">
      
        <h2 id="简单工厂"><a href="#简单工厂" class="headerlink" title="简单工厂"></a>简单工厂</h2><p>类如果直接都用new,那有一天命名需要改动的时候得搜索每一行代码去改，而工厂避免了这种情况</p>
<p>会让我们的代码更具结构化，便于管理和扩展。</p>
<p>比如，我们有一些类，它们都继承自交通工具类：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Vehicle</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">drive</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">implements</span> <span class="title">Vehicle</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">drive</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;汽车靠四个轮子滚动行走。&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ship</span> <span class="keyword">implements</span> <span class="title">Vehicle</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">drive</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;轮船靠螺旋桨划水前进。&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aircraft</span> <span class="keyword">implements</span> <span class="title">Vehicle</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">drive</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;飞机靠螺旋桨和机翼的升力飞行。&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>再创建一个工厂类，专门用作类的创建，：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VehicleFactory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">build</span>(<span class="params"><span class="variable">$className</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$className</span> = ucfirst(<span class="variable">$className</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$className</span> &amp;&amp; class_exists(<span class="variable">$className</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">$className</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>工厂类用了一个静态方法来创建其他类，在客户端中就可以这样使用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">VehicleFactory::build(<span class="string">&#x27;Car&#x27;</span>)-&gt;drive();</span><br><span class="line">VehicleFactory::build(<span class="string">&#x27;Ship&#x27;</span>)-&gt;drive();</span><br><span class="line">VehicleFactory::build(<span class="string">&#x27;Aircraft&#x27;</span>)-&gt;drive();</span><br></pre></td></tr></table></figure>

<p>省去了每次都要new类的工作。</p>

      
    </div-->

    <footer class="article-footer">
      <a data-url="https://jsonlocker.github.io/2021/06/16/patter-simple-factory-php/" data-id="cl5m5t612004vrhqwhm48ay6p" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/patterns/" rel="tag">patterns</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/simple-factory/" rel="tag">simple factory</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-patter-adapter" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/05/28/patter-adapter/" class="article-date">
  <time datetime="2021-05-28T10:50:04.000Z" itemprop="datePublished">2021-05-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/patterns/">patterns</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/05/28/patter-adapter/">适配器模式</a>
    </h1>
  

      </header>
    

    
    <div class="article-entry" itemprop="articleBody">
      
        
        
          <h2 id="适配器模式"><a href="#适配器模式" class="headerlink" title="适配器模式"></a>适配器模式</h2><p>适配器模式，即根据客户端需要，将某个类的接口转换成特定样式的接口，以解决类之间的兼容问题。</p>
          
            <p class="article-more-link">
              <a href="/2021/05/28/patter-adapter/#more">Read More</a>
            </p>
          
        
      
    </div> 

    <!--div class="article-entry" itemprop="articleBody">
      
        <h2 id="适配器模式"><a href="#适配器模式" class="headerlink" title="适配器模式"></a>适配器模式</h2><p>适配器模式，即根据客户端需要，将某个类的接口转换成特定样式的接口，以解决类之间的兼容问题。</p>
<p>如果我们的代码依赖一些外部的API，或者依赖一些可能会经常更改的类，那么应该考虑用适配器模式。</p>
<p>下面我们以集成支付宝支付功能为例。</p>
<h3 id="1-问题"><a href="#1-问题" class="headerlink" title="1. 问题"></a>1. 问题</h3><p>假设支付宝支付类功能</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 支付宝支付类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Alipay</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sendPayment</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;使用支付宝支付。&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 客户端代码</span></span><br><span class="line"><span class="variable">$alipay</span> = <span class="keyword">new</span> Alipay();</span><br><span class="line"><span class="variable">$alipay</span>-&gt;sendPayment();</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我们直接实例化Alipay类完成支付功能，这样的客户端代码可能很多。</p>
<p>一段时间后，如果支付宝的Alipay类升级，方法名由sendPayment()变成goPayment()会怎样？</p>
<p>所有用了sendPayment()的客户端代码都要改变。</p>
<p>如果Alipay类频繁升级，或者客户端在很多地方使用，这会是极大的工作量。</p>
<h3 id="2-解决"><a href="#2-解决" class="headerlink" title="2. 解决"></a>2. 解决</h3><p>现在我们用适配器模式来解决。</p>
<p>我们在客户端和Alipay类之间加一个中间类，也就是适配器类，转换原始的Alipay为客户端需要的形式。</p>
<p>为让客户端能调用到统一的类方法，我们先定义一个适配器接口：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 适配器接口，所有的支付适配器都需实现这个接口。</span></span><br><span class="line"><span class="comment"> * 不管第三方支付实现方式如何，对于客户端来说，都</span></span><br><span class="line"><span class="comment"> * 用pay()方法完成支付</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">PayAdapter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">pay</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>因为Alipay类我们无法控制，而且它有可能经常更新，所以我们不对它做任何修改。</p>
<p>我们新建一个AlipayAdapter适配器类，在pay()中转换Alipay的支付功能，如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 支付宝适配器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AlipayAdapter</span> <span class="keyword">implements</span> <span class="title">PayAdapter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">pay</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 实例化Alipay类，并用Alipay的方法实现支付</span></span><br><span class="line">        <span class="variable">$alipay</span> = <span class="keyword">new</span> Alipay();</span><br><span class="line">        <span class="variable">$alipay</span>-&gt;sendPayment();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>客户端使用方式：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 客户端代码</span></span><br><span class="line"><span class="variable">$alipay</span> = <span class="keyword">new</span> AlipayAdapter();</span><br><span class="line"><span class="comment">// 用pay()方法实现支付</span></span><br><span class="line"><span class="variable">$alipay</span>-&gt;pay();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样，当Alipay的支付方法改变，只需要修改AlipayAdapter类就可以了。</p>
<h3 id="3-适配新类"><a href="#3-适配新类" class="headerlink" title="3. 适配新类"></a>3. 适配新类</h3><p>有了适配器后，扩展也变得更容易了。</p>
<p>继续以上的例子，在支付宝的基础上，我们再增加微信支付，它与支付宝的支付方式不同，必须通过扫码才能支付。</p>
<p>这种情况也应该使用适配器，而不是直接使用微信的支付功能。</p>
<p>代码如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 微信支付类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WechatPay</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">scan</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;扫描二维码后，&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">doPay</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;使用微信支付&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 微信支付适配器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WechatPayAdapter</span> <span class="keyword">implements</span> <span class="title">PayAdapter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">pay</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 实例化WechatPay类，并用WechatPay的方法实现支付。</span></span><br><span class="line">        <span class="comment">// 注意，微信支付的方式和支付宝的支付方式不一样，但是</span></span><br><span class="line">        <span class="comment">// 适配之后，他们都能用pay()来实现支付功能。</span></span><br><span class="line">        <span class="variable">$wechatPay</span> = <span class="keyword">new</span> WechatPay();</span><br><span class="line">        <span class="variable">$wechatPay</span>-&gt;scan();</span><br><span class="line">        <span class="variable">$wechatPay</span>-&gt;doPay();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>客户端使用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 客户端代码</span></span><br><span class="line"><span class="variable">$wechat</span> = <span class="keyword">new</span> WechatPayAdapter();</span><br><span class="line"><span class="comment">// 也是用pay()方法实现支付</span></span><br><span class="line"><span class="variable">$wechat</span>-&gt;pay();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这就是适配器的扩展特性。</p>
<p>我们创建了一个用于处理第三方类（支付宝、微信支付）的方法，</p>
<p>如果它们的API有变化，我们仅需修改客户端依赖的适配器类就可以，不用修改、暴露第三方类本身。</p>
<p>注意：适配器模式中，适配器类的名称和创建方式一定是不会频繁改动的。</p>
<p>对于客户端来说，引用适配器类的方式应该是统一而不变的，这才算是正确使用适配器。</p>
<h3 id="4-总结"><a href="#4-总结" class="headerlink" title="4. 总结"></a>4. 总结</h3><p>大的应用都会不断地加入新库和新API。</p>
<p>为避免它们的变更引发问题，应该用适配器模式包装起来，提供应用统一的引用方式。</p>
<p>它会让我们的代码更具结构化，便于管理和扩展。</p>

      
    </div-->

    <footer class="article-footer">
      <a data-url="https://jsonlocker.github.io/2021/05/28/patter-adapter/" data-id="cl5m5t60t004irhqwbem34a0w" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/adapter/" rel="tag">adapter</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/patterns/" rel="tag">patterns</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/" rel="tag">php</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/3/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Javascript/">Javascript</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/WebSafe/">WebSafe</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/patterns/">patterns</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSRF/" style="font-size: 10px;">CSRF</a> <a href="/tags/ES6/" style="font-size: 10px;">ES6</a> <a href="/tags/Javascript/" style="font-size: 10px;">Javascript</a> <a href="/tags/Localstorage/" style="font-size: 10px;">Localstorage</a> <a href="/tags/MD5/" style="font-size: 10px;">MD5</a> <a href="/tags/OS/" style="font-size: 10px;">OS</a> <a href="/tags/PHP/" style="font-size: 11.25px;">PHP</a> <a href="/tags/SEO/" style="font-size: 10px;">SEO</a> <a href="/tags/SQL/" style="font-size: 11.25px;">SQL</a> <a href="/tags/XSS/" style="font-size: 10px;">XSS</a> <a href="/tags/adapter/" style="font-size: 10px;">adapter</a> <a href="/tags/advanced/" style="font-size: 10px;">advanced</a> <a href="/tags/apuc/" style="font-size: 10px;">apuc</a> <a href="/tags/asset/" style="font-size: 10px;">asset</a> <a href="/tags/btree%E7%B4%A2%E5%BC%95/" style="font-size: 10px;">btree索引</a> <a href="/tags/compile/" style="font-size: 10px;">compile</a> <a href="/tags/complie/" style="font-size: 11.25px;">complie</a> <a href="/tags/components/" style="font-size: 10px;">components</a> <a href="/tags/composer/" style="font-size: 10px;">composer</a> <a href="/tags/composite/" style="font-size: 10px;">composite</a> <a href="/tags/config/" style="font-size: 10px;">config</a> <a href="/tags/cors/" style="font-size: 10px;">cors</a> <a href="/tags/cpu/" style="font-size: 10px;">cpu</a> <a href="/tags/curd/" style="font-size: 10px;">curd</a> <a href="/tags/decorator/" style="font-size: 10px;">decorator</a> <a href="/tags/designDB/" style="font-size: 12.5px;">designDB</a> <a href="/tags/designdb/" style="font-size: 20px;">designdb</a> <a href="/tags/encrypt/" style="font-size: 10px;">encrypt</a> <a href="/tags/engine/" style="font-size: 10px;">engine</a> <a href="/tags/fetch/" style="font-size: 10px;">fetch</a> <a href="/tags/final%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/" style="font-size: 10px;">final类和方法</a> <a href="/tags/hash%E7%B4%A2%E5%BC%95/" style="font-size: 10px;">hash索引</a> <a href="/tags/http-proxy/" style="font-size: 10px;">http proxy</a> <a href="/tags/https/" style="font-size: 10px;">https</a> <a href="/tags/index/" style="font-size: 11.25px;">index</a> <a href="/tags/input/" style="font-size: 10px;">input</a> <a href="/tags/install/" style="font-size: 10px;">install</a> <a href="/tags/ip/" style="font-size: 10px;">ip</a> <a href="/tags/javascript/" style="font-size: 16.25px;">javascript</a> <a href="/tags/laravel/" style="font-size: 13.75px;">laravel</a> <a href="/tags/linux/" style="font-size: 13.75px;">linux</a> <a href="/tags/lnmp/" style="font-size: 13.75px;">lnmp</a> <a href="/tags/locating/" style="font-size: 10px;">locating</a> <a href="/tags/mailer/" style="font-size: 10px;">mailer</a> <a href="/tags/mindManger-software/" style="font-size: 10px;">mindManger - software</a> <a href="/tags/mysql/" style="font-size: 18.75px;">mysql</a> <a href="/tags/mysql-%E4%BA%8C%E8%BF%9B%E5%88%B6/" style="font-size: 10px;">mysql 二进制</a> <a href="/tags/mysql-%E5%A4%8D%E5%88%B6/" style="font-size: 10px;">mysql 复制</a> <a href="/tags/mysqld/" style="font-size: 10px;">mysqld</a> <a href="/tags/mysqlslap/" style="font-size: 10px;">mysqlslap</a> <a href="/tags/mysql%E4%BC%98%E5%8C%96/" style="font-size: 10px;">mysql优化</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/nosql/" style="font-size: 10px;">nosql</a> <a href="/tags/observer/" style="font-size: 10px;">observer</a> <a href="/tags/ocr/" style="font-size: 10px;">ocr</a> <a href="/tags/opencart/" style="font-size: 11.25px;">opencart</a> <a href="/tags/optimizer/" style="font-size: 10px;">optimizer</a> <a href="/tags/patterns/" style="font-size: 15px;">patterns</a> <a href="/tags/pdo/" style="font-size: 10px;">pdo</a> <a href="/tags/php/" style="font-size: 17.5px;">php</a> <a href="/tags/php7/" style="font-size: 10px;">php7</a> <a href="/tags/predis/" style="font-size: 10px;">predis</a> <a href="/tags/proxy/" style="font-size: 10px;">proxy</a> <a href="/tags/python/" style="font-size: 11.25px;">python</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/register/" style="font-size: 10px;">register</a> <a href="/tags/regular/" style="font-size: 10px;">regular</a> <a href="/tags/rewrite/" style="font-size: 10px;">rewrite</a> <a href="/tags/route/" style="font-size: 11.25px;">route</a> <a href="/tags/self-parent/" style="font-size: 10px;">self & parent</a> <a href="/tags/shadowsocks/" style="font-size: 10px;">shadowsocks</a> <a href="/tags/shadowsocks-libev/" style="font-size: 10px;">shadowsocks-libev</a> <a href="/tags/simple-factory/" style="font-size: 10px;">simple factory</a> <a href="/tags/software/" style="font-size: 10px;">software</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/ssl/" style="font-size: 10px;">ssl</a> <a href="/tags/ssr/" style="font-size: 10px;">ssr</a> <a href="/tags/static/" style="font-size: 10px;">static</a> <a href="/tags/sysbench/" style="font-size: 10px;">sysbench</a> <a href="/tags/tesseract/" style="font-size: 10px;">tesseract</a> <a href="/tags/textarea/" style="font-size: 10px;">textarea</a> <a href="/tags/this/" style="font-size: 10px;">this</a> <a href="/tags/tinyproxy/" style="font-size: 10px;">tinyproxy</a> <a href="/tags/turtle/" style="font-size: 10px;">turtle</a> <a href="/tags/twig/" style="font-size: 10px;">twig</a> <a href="/tags/urlmanager/" style="font-size: 10px;">urlmanager</a> <a href="/tags/v2ray/" style="font-size: 10px;">v2ray</a> <a href="/tags/vmess/" style="font-size: 10px;">vmess</a> <a href="/tags/web-components/" style="font-size: 10px;">web components</a> <a href="/tags/yii2/" style="font-size: 13.75px;">yii2</a> <a href="/tags/%E4%B8%BB%E4%BB%8E%E6%8B%93%E6%89%91/" style="font-size: 10px;">主从拓扑</a> <a href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%A4%8D%E5%88%B6/" style="font-size: 10px;">二进制复制</a> <a href="/tags/%E5%86%85%E5%AD%98/" style="font-size: 10px;">内存</a> <a href="/tags/%E5%89%8D%E7%9E%BB%E5%90%8E%E9%A1%BE/" style="font-size: 10px;">前瞻后顾</a> <a href="/tags/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" style="font-size: 10px;">单例模式</a> <a href="/tags/%E5%8F%8D%E8%8C%83%E5%BC%8F%E5%8C%96/" style="font-size: 10px;">反范式化</a> <a href="/tags/%E5%9F%BA%E5%87%86%E6%B5%8B%E8%AF%95/" style="font-size: 12.5px;">基准测试</a> <a href="/tags/%E5%AE%89%E8%A3%85%E6%BC%94%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 10px;">安装演示数据库</a> <a href="/tags/%E5%AE%9A%E6%9C%9F%E5%A4%87%E4%BB%BD/" style="font-size: 10px;">定期备份</a> <a href="/tags/%E5%B0%81%E8%A3%85%E6%80%A7/" style="font-size: 10px;">封装性</a> <a href="/tags/%E5%B8%B8%E8%A7%81%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/" style="font-size: 10px;">常见安全问题</a> <a href="/tags/%E6%8A%BD%E8%B1%A1%E7%B1%BB/" style="font-size: 10px;">抽象类</a> <a href="/tags/%E6%8E%A5%E5%8F%A3/" style="font-size: 10px;">接口</a> <a href="/tags/%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB/" style="font-size: 10px;">文字识别</a> <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 10px;">正则表达式</a> <a href="/tags/%E7%89%A9%E7%90%86%E8%AE%BE%E8%AE%A1/" style="font-size: 10px;">物理设计</a> <a href="/tags/%E7%94%BB%E5%9B%BE/" style="font-size: 10px;">画图</a> <a href="/tags/%E7%A1%AC%E4%BB%B6%E5%BD%B1%E5%93%8D/" style="font-size: 10px;">硬件影响</a> <a href="/tags/%E7%A3%81%E7%9B%98%E9%85%8D%E7%BD%AE/" style="font-size: 10px;">磁盘配置</a> <a href="/tags/%E7%B1%BB%E5%B8%B8%E9%87%8F/" style="font-size: 10px;">类常量</a> <a href="/tags/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/" style="font-size: 10px;">索引优化</a> <a href="/tags/%E7%BB%A7%E6%89%BF%E6%80%A7/" style="font-size: 10px;">继承性</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8A%A0%E8%BD%BD/" style="font-size: 10px;">自动加载</a> <a href="/tags/%E8%8C%83%E5%BC%8F%E5%8C%96/" style="font-size: 10px;">范式化</a> <a href="/tags/%E8%AF%AD%E6%B3%95%E6%95%B4%E7%90%86/" style="font-size: 10px;">语法整理</a> <a href="/tags/%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A1/" style="font-size: 10px;">逻辑设计</a> <a href="/tags/%E9%9D%99%E6%80%81%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95/" style="font-size: 10px;">静态属性和方法</a> <a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 12.5px;">面向对象</a> <a href="/tags/%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84/" style="font-size: 10px;">高可用架构</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a><span class="archive-list-count">33</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">7</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/07/15/laravel-4-customfunc-php/">laravel 自定义函数和变量</a>
          </li>
        
          <li>
            <a href="/2022/02/11/laravel-3-controller/">laravel-3-controller</a>
          </li>
        
          <li>
            <a href="/2022/02/09/laravel-2-route/">laravel-2-route</a>
          </li>
        
          <li>
            <a href="/2022/02/08/laravel-init/">laravel_init</a>
          </li>
        
          <li>
            <a href="/2022/02/08/sql-miss-index/">sql_miss_index</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Jsonlocker<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="js/mouse.js"></script>

<script type="text/javascript">
//<![CDATA[
if (typeof jQuery == 'undefined') {
document.write(unescape("%3Cscript src='/js/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));
}
// ]]>
</script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>