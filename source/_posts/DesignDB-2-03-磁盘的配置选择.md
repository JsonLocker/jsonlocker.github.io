---
title: DesignDB-2-03_磁盘的配置选择
date: 2018-06-15 17:22:06
categories: mysql
tags:
    - designdb
    - 磁盘配置
---

## 磁盘的配置选择

### 1-  使用传统机器硬盘

#### 特点:
    - 最常见
    - 价格低
    - 最常见
    - 容量大
    - 读取慢

#### 选购考量

1. 存储容量
2. 传输速度
3. 访问时间
4. 主轴转速(7200转以上,越快越好)
5. 物理尺寸


### 2. 使用RAID增强传统机器硬盘性能

RAID 是磁盘冗余队列的简称(Redudant Arrays of Independent Disks)

作用:是把多个小容量磁盘组合成大磁盘，并提供数据冗余来保证数据完整性.

RAID级别:
    - RAID 0(性价比最高,无数据安全性保障)
        - 需要2块以上的磁盘组建,也叫数据条带
        - 最常见
        - 价格低
        - 提高磁盘性能和吞吐量
        - 没有冗余和错误修复能力,任何一个损坏都造成数据丢失
        - 串联的多磁盘容量,并联读取能力

    - RAID 1(磁盘镜像) 
        - 把一块磁盘数据镜像到另外一块
        - 写入一块磁盘同时,在另外一个磁盘生成镜像文件
        - 可保障系统可靠性和可修复性

    - RAID 5(分布式奇偶校验磁盘)
        通过分布式奇偶校验块把数据分散到多个磁盘中，如果任何一个磁盘数据失效，都可以从奇偶校验块中重建。如果同时失效则整个数据都无法恢复。适合读取较多的环境。

    - RAID 10(分片的镜像，推荐!!)
        － 先对磁盘RAID1之后对两组RAID1磁盘再做RAID0
        － 有良好的性能
        - 相对RAID 5，重建更简单，速度也更快


对比和选择

等级|特点|是否冗余|盘数|读｜写
--|--|--|--|--|--
RAID0|便宜,快速,危险|否|N|快|快
RAID1|高速读,简单,安全|有|2|快|慢
RAID5|安全,成本折中|有|N+1|快|取决于最慢的盘
RAID10|贵,高速，安全|有|2N|快|快
        
## 3. 使用固态存储SSD盒PCIe卡
- 相对传统磁盘有更好的随机读写性能
- 相比机械磁盘有更好的并发操作
- 相比机械磁盘,更容易损坏

SSD
    - 使用SATA接口
    - 可以替换传统磁盘可以不需要任何改变
    - SATA接口的SSD同样支持RAID技术

PCI-E SSD(Fusion-IO)
    - 无法使用SATA接口,需另外驱动和配置
    - 性能高于SSD,价格则更贵多多
    - 注意:会牺牲服务器的内存和CPU

使用场景
    － 适用于大量的随机I/O的场景
    - 单线程负载的I/O瓶颈
    - 适合用在从服务器上,不适合用在主服务器上,读取更好,不怕数据损伤

### 4. 使用网络存储NAS和SAN
     是两种外部文件存储设备加载到服务器的方法

SAN（Storage Area Network)
    - SAN 通过光纤连接到服务器，可当作磁盘
    - SAN 可支持大量顺序读写操作
    - 随机读写慢,不如本地RAID磁盘
    
NAS(Network-Attached Storage)
    - 使用网络连接,基于文件协议如NFS或SMB来访问
    - 会有网络延迟

适合的场景:
    - 数据库备份

影响因素:
    - 带宽
    - 延迟

建议:
    - 采用高性能和高带宽的网络接口设备和交换机
    - 对多个网卡进行绑定,增加可用性和带宽
    - 尽可能进行网络隔离，特别是内外网隔离

### 总结:

**CPU**
    - 64位CPU一定要工作在64位系统下
    - 对于并发高的场景,CPU的数量比频率重要
    - 对于CPU密集性场景和复杂SQL则频率越高越好

**Memory**
    - 选择主板所支持的最高频率的内存
    - 内存大小对性能影响很大,所以尽量的大

**I/O子系统**
    - PCIe > SSD > Raid10 > 磁盘> SAN
    


